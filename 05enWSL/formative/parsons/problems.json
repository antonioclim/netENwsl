{
  "metadata": {
    "week": 5,
    "topic": "IP Addressing, Subnetting and VLSM",
    "version": "1.1.0",
    "total_problems": 5,
    "description": "Parsons problems for code/command block reordering with distractors"
  },
  "problems": [
    {
      "id": "parsons_01",
      "title": "Calculate Usable Hosts from CIDR",
      "lo_ref": "LO3",
      "bloom_level": "apply",
      "difficulty": "basic",
      "instructions": "Arrange the code blocks to create a function that calculates usable hosts from a CIDR prefix. Some blocks are distractors and should not be used.",
      "language": "python",
      "blocks": [
        {"id": 1, "code": "def usable_hosts(prefix: int) -> int:", "indent": 0, "is_distractor": false},
        {"id": 2, "code": "    \"\"\"Calculate usable hosts from CIDR prefix.\"\"\"", "indent": 1, "is_distractor": false},
        {"id": 3, "code": "    host_bits = 32 - prefix", "indent": 1, "is_distractor": false},
        {"id": 4, "code": "    total_addresses = 2 ** host_bits", "indent": 1, "is_distractor": false},
        {"id": 5, "code": "    return total_addresses - 2", "indent": 1, "is_distractor": false},
        {"id": 6, "code": "    host_bits = prefix - 32", "indent": 1, "is_distractor": true},
        {"id": 7, "code": "    return total_addresses", "indent": 1, "is_distractor": true},
        {"id": 8, "code": "    return total_addresses + 2", "indent": 1, "is_distractor": true}
      ],
      "correct_order": [1, 2, 3, 4, 5],
      "explanation": "The function calculates host bits (32 - prefix), then total addresses (2^host_bits), then subtracts 2 for network and broadcast addresses."
    },
    {
      "id": "parsons_02",
      "title": "VLSM Allocation Algorithm",
      "lo_ref": "LO5",
      "bloom_level": "apply",
      "difficulty": "intermediate",
      "instructions": "Arrange the steps to correctly perform VLSM allocation. Include only the correct steps in the right order.",
      "language": "pseudocode",
      "blocks": [
        {"id": 1, "code": "1. Sort requirements by host count (LARGEST FIRST)", "indent": 0, "is_distractor": false},
        {"id": 2, "code": "2. Set cursor to network start address", "indent": 0, "is_distractor": false},
        {"id": 3, "code": "3. For each requirement:", "indent": 0, "is_distractor": false},
        {"id": 4, "code": "    a. Calculate minimum prefix for hosts needed", "indent": 1, "is_distractor": false},
        {"id": 5, "code": "    b. Align cursor to block boundary", "indent": 1, "is_distractor": false},
        {"id": 6, "code": "    c. Allocate subnet at cursor position", "indent": 1, "is_distractor": false},
        {"id": 7, "code": "    d. Advance cursor by block size", "indent": 1, "is_distractor": false},
        {"id": 8, "code": "1. Sort requirements by host count (SMALLEST FIRST)", "indent": 0, "is_distractor": true},
        {"id": 9, "code": "    a. Use /24 for all allocations", "indent": 1, "is_distractor": true},
        {"id": 10, "code": "    b. Skip alignment (not needed)", "indent": 1, "is_distractor": true}
      ],
      "correct_order": [1, 2, 3, 4, 5, 6, 7],
      "explanation": "VLSM requires largest-first sorting to prevent fragmentation."
    },
    {
      "id": "parsons_03",
      "title": "IPv6 Address Compression",
      "lo_ref": "LO2",
      "bloom_level": "understand",
      "difficulty": "intermediate",
      "instructions": "Arrange the steps to correctly compress an IPv6 address. Avoid the distractor blocks.",
      "language": "pseudocode",
      "blocks": [
        {"id": 1, "code": "1. Remove leading zeros from each group", "indent": 0, "is_distractor": false},
        {"id": 2, "code": "2. Find the longest run of consecutive all-zero groups", "indent": 0, "is_distractor": false},
        {"id": 3, "code": "3. Replace that run with :: (only once!)", "indent": 0, "is_distractor": false},
        {"id": 4, "code": "4. If multiple equal-length runs exist, replace the leftmost", "indent": 0, "is_distractor": false},
        {"id": 5, "code": "2. Find any zero group and remove it", "indent": 0, "is_distractor": true},
        {"id": 6, "code": "3. Replace all zero groups with ::", "indent": 0, "is_distractor": true},
        {"id": 7, "code": "4. Add :: at both ends for safety", "indent": 0, "is_distractor": true}
      ],
      "correct_order": [1, 2, 3, 4],
      "explanation": "IPv6 compression follows RFC 5952: remove leading zeros, find longest consecutive zero run, replace with :: (only once)."
    },
    {
      "id": "parsons_04",
      "title": "Network Address Calculation",
      "lo_ref": "LO3",
      "bloom_level": "apply",
      "difficulty": "basic",
      "instructions": "Arrange the Python code to calculate the network address from an IP and prefix. Exclude distractors.",
      "language": "python",
      "blocks": [
        {"id": 1, "code": "import ipaddress", "indent": 0, "is_distractor": false},
        {"id": 2, "code": "", "indent": 0, "is_distractor": false},
        {"id": 3, "code": "def get_network_address(ip_cidr: str) -> str:", "indent": 0, "is_distractor": false},
        {"id": 4, "code": "    interface = ipaddress.ip_interface(ip_cidr)", "indent": 1, "is_distractor": false},
        {"id": 5, "code": "    network = interface.network", "indent": 1, "is_distractor": false},
        {"id": 6, "code": "    return str(network.network_address)", "indent": 1, "is_distractor": false},
        {"id": 7, "code": "    return str(interface)", "indent": 1, "is_distractor": true},
        {"id": 8, "code": "    network = interface.broadcast_address", "indent": 1, "is_distractor": true},
        {"id": 9, "code": "from socket import inet_aton", "indent": 0, "is_distractor": true}
      ],
      "correct_order": [1, 2, 3, 4, 5, 6],
      "explanation": "Use ipaddress module to parse the interface, get its network, then extract the network_address."
    },
    {
      "id": "parsons_05",
      "title": "Start Week 5 Lab Environment",
      "lo_ref": "LO1",
      "bloom_level": "remember",
      "difficulty": "basic",
      "instructions": "Arrange the commands in the correct order to start the Week 5 laboratory environment. Avoid distractor commands.",
      "language": "bash",
      "blocks": [
        {"id": 1, "code": "cd /mnt/d/NETWORKING/WEEK5/05enWSL", "indent": 0, "is_distractor": false},
        {"id": 2, "code": "sudo service docker start", "indent": 0, "is_distractor": false},
        {"id": 3, "code": "python3 setup/verify_environment.py", "indent": 0, "is_distractor": false},
        {"id": 4, "code": "python3 scripts/start_lab.py", "indent": 0, "is_distractor": false},
        {"id": 5, "code": "docker ps", "indent": 0, "is_distractor": false},
        {"id": 6, "code": "docker compose up -d", "indent": 0, "is_distractor": true},
        {"id": 7, "code": "sudo apt install docker", "indent": 0, "is_distractor": true},
        {"id": 8, "code": "cd /home/WEEK5", "indent": 0, "is_distractor": true}
      ],
      "correct_order": [1, 2, 3, 4, 5],
      "explanation": "Navigate to kit directory, start Docker service, verify environment, run start script, then verify with docker ps."
    }
  ]
}
