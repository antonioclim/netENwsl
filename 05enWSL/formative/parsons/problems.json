{
  "metadata": {
    "week": 5,
    "topic": "IP Addressing, Subnetting and VLSM",
    "version": "1.2.0",
    "problem_count": 8
  },
  "problems": [
    {
      "id": "P1",
      "title": "Calculate Usable Hosts",
      "difficulty": "basic",
      "blocks": [
        {"id": "A", "code": "    return total - 2", "distractor": false},
        {"id": "B", "code": "def usable_hosts(prefix: int) -> int:", "distractor": false},
        {"id": "C", "code": "    host_bits = 32 - prefix", "distractor": false},
        {"id": "D", "code": "    total = 2 ** host_bits", "distractor": false},
        {"id": "E", "code": "    total = host_bits ** 2", "distractor": true},
        {"id": "F", "code": "    return total", "distractor": true}
      ],
      "solution": ["B", "C", "D", "A"],
      "explanation": "Block E uses wrong formula (should be 2^bits). Block F forgets to subtract 2."
    },
    {
      "id": "P2",
      "title": "VLSM Sort Requirements",
      "difficulty": "intermediate",
      "blocks": [
        {"id": "A", "code": "    return sorted_reqs", "distractor": false},
        {"id": "B", "code": "def sort_vlsm_requirements(hosts: list) -> list:", "distractor": false},
        {"id": "C", "code": "    sorted_reqs = sorted(indexed, key=lambda x: -x[1])", "distractor": false},
        {"id": "D", "code": "    indexed = list(enumerate(hosts))", "distractor": false},
        {"id": "E", "code": "    sorted_reqs = sorted(indexed, key=lambda x: x[1])", "distractor": true},
        {"id": "F", "code": "    indexed = hosts.copy()", "distractor": true}
      ],
      "solution": ["B", "D", "C", "A"],
      "explanation": "Block E sorts ascending (wrong for VLSM). Block F doesn't preserve indices."
    },
    {
      "id": "P3",
      "title": "Calculate Network Address",
      "difficulty": "intermediate",
      "blocks": [
        {"id": "A", "code": "    return str(ipaddress.IPv4Address(network_int))", "distractor": false},
        {"id": "B", "code": "def get_network_address(ip: str, prefix: int) -> str:", "distractor": false},
        {"id": "C", "code": "    mask = (0xFFFFFFFF << (32 - prefix)) & 0xFFFFFFFF", "distractor": false},
        {"id": "D", "code": "    ip_int = int(ipaddress.IPv4Address(ip))", "distractor": false},
        {"id": "E", "code": "    network_int = ip_int & mask", "distractor": false},
        {"id": "F", "code": "    network_int = ip_int | mask", "distractor": true},
        {"id": "G", "code": "    mask = 0xFFFFFFFF >> prefix", "distractor": true}
      ],
      "solution": ["B", "D", "C", "E", "A"],
      "explanation": "Block F uses OR (sets bits). Block G creates wrong mask direction."
    },
    {
      "id": "P4",
      "title": "IPv6 Compression Check",
      "difficulty": "basic",
      "blocks": [
        {"id": "A", "code": "    return address.count('::') <= 1", "distractor": false},
        {"id": "B", "code": "def is_valid_ipv6_compression(address: str) -> bool:", "distractor": false},
        {"id": "C", "code": "    return '::' in address", "distractor": true},
        {"id": "D", "code": "    return address.count('::') == 1", "distractor": true}
      ],
      "solution": ["B", "A"],
      "explanation": "Block C only checks presence. Block D requires exactly one (but zero is valid)."
    },
    {
      "id": "P5",
      "title": "Lab Startup Sequence",
      "difficulty": "basic",
      "blocks": [
        {"id": "A", "code": "Check containers are running", "distractor": false},
        {"id": "B", "code": "Go to kit directory", "distractor": false},
        {"id": "C", "code": "Start Docker service", "distractor": false},
        {"id": "D", "code": "Run docker-compose up", "distractor": false},
        {"id": "E", "code": "Verify environment prerequisites", "distractor": false},
        {"id": "F", "code": "Install Docker Desktop", "distractor": true}
      ],
      "solution": ["B", "C", "E", "D", "A"],
      "explanation": "Block F is only for initial setup, not every lab start."
    },
    {
      "id": "P6",
      "title": "Prefix for Hosts Calculation",
      "difficulty": "intermediate",
      "blocks": [
        {"id": "A", "code": "    return 32 - host_bits", "distractor": false},
        {"id": "B", "code": "def prefix_for_hosts(needed: int) -> int:", "distractor": false},
        {"id": "C", "code": "import math", "distractor": false},
        {"id": "D", "code": "    total_needed = needed + 2", "distractor": false},
        {"id": "E", "code": "    host_bits = math.ceil(math.log2(total_needed))", "distractor": false},
        {"id": "F", "code": "    host_bits = math.floor(math.log2(needed))", "distractor": true},
        {"id": "G", "code": "    total_needed = needed", "distractor": true}
      ],
      "solution": ["C", "B", "D", "E", "A"],
      "explanation": "Block F uses floor and no +2. Block G forgets network/broadcast."
    },
    {
      "id": "P7",
      "title": "Broadcast Address Calculation",
      "difficulty": "intermediate",
      "blocks": [
        {"id": "A", "code": "    return str(ipaddress.IPv4Address(broadcast_int))", "distractor": false},
        {"id": "B", "code": "def get_broadcast(network: str, prefix: int) -> str:", "distractor": false},
        {"id": "C", "code": "    block_size = 2 ** (32 - prefix)", "distractor": false},
        {"id": "D", "code": "    network_int = int(ipaddress.IPv4Address(network))", "distractor": false},
        {"id": "E", "code": "    broadcast_int = network_int + block_size - 1", "distractor": false},
        {"id": "F", "code": "    broadcast_int = network_int + block_size", "distractor": true},
        {"id": "G", "code": "    block_size = 32 - prefix", "distractor": true}
      ],
      "solution": ["B", "D", "C", "E", "A"],
      "explanation": "Block F doesn't subtract 1. Block G confuses block size with host bits."
    },
    {
      "id": "P8",
      "title": "FLSM Subnet Validation",
      "difficulty": "advanced",
      "blocks": [
        {"id": "A", "code": "    return is_power_of_2", "distractor": false},
        {"id": "B", "code": "def validate_flsm_count(n: int) -> bool:", "distractor": false},
        {"id": "C", "code": "    if n <= 0:\n        return False", "distractor": false},
        {"id": "D", "code": "    is_power_of_2 = (n & (n - 1)) == 0", "distractor": false},
        {"id": "E", "code": "    is_power_of_2 = n % 2 == 0", "distractor": true},
        {"id": "F", "code": "    if n < 0:\n        return False", "distractor": true}
      ],
      "solution": ["B", "C", "D", "A"],
      "explanation": "Block E only checks even (6 is even but not power of 2). Block F allows 0."
    }
  ]
}
