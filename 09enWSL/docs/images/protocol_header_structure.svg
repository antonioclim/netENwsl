<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 320" width="700" height="320">
  <title>Binary Protocol Header Structure</title>
  <desc>Week 9 protocol header format: magic + version + flags + length + CRC</desc>
  
  <!-- Background -->
  <rect width="700" height="320" fill="#f8f9fa"/>
  
  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#333">Binary Protocol Header Structure</text>
  <text x="350" y="50" text-anchor="middle" font-family="monospace" font-size="12" fill="#666">Format: "&gt;4sBBII" (14 bytes total)</text>
  
  <!-- Header bytes visualization -->
  <!-- Byte numbers -->
  <text x="50" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#666">Byte:</text>
  <text x="100" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">0</text>
  <text x="140" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">1</text>
  <text x="180" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">2</text>
  <text x="220" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">3</text>
  <text x="260" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">4</text>
  <text x="300" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">5</text>
  <text x="340" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">6</text>
  <text x="380" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">7</text>
  <text x="420" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">8</text>
  <text x="460" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">9</text>
  <text x="500" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">10</text>
  <text x="540" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">11</text>
  <text x="580" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">12</text>
  <text x="620" y="85" text-anchor="middle" font-family="monospace" font-size="10" fill="#666">13</text>
  
  <!-- Magic bytes (4 bytes) -->
  <rect x="80" y="95" width="160" height="50" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
  <text x="160" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#155724">Magic (4s)</text>
  <text x="160" y="135" text-anchor="middle" font-family="monospace" font-size="12" fill="#155724">"S9PK"</text>
  
  <!-- Version (1 byte) -->
  <rect x="240" y="95" width="40" height="50" fill="#cce5ff" stroke="#007bff" stroke-width="2"/>
  <text x="260" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#004085">Ver</text>
  <text x="260" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#004085">(B)</text>
  <text x="260" y="142" text-anchor="middle" font-family="monospace" font-size="10" fill="#004085">0x01</text>
  
  <!-- Flags (1 byte) -->
  <rect x="280" y="95" width="40" height="50" fill="#e2d5f1" stroke="#6f42c1" stroke-width="2"/>
  <text x="300" y="115" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#4a2c7a">Flg</text>
  <text x="300" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#4a2c7a">(B)</text>
  <text x="300" y="142" text-anchor="middle" font-family="monospace" font-size="10" fill="#4a2c7a">0x00</text>
  
  <!-- Length (4 bytes) -->
  <rect x="320" y="95" width="160" height="50" fill="#fff3cd" stroke="#ffc107" stroke-width="2"/>
  <text x="400" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#856404">Length (I)</text>
  <text x="400" y="135" text-anchor="middle" font-family="monospace" font-size="12" fill="#856404">payload size</text>
  
  <!-- CRC-32 (4 bytes) -->
  <rect x="480" y="95" width="160" height="50" fill="#f8d7da" stroke="#dc3545" stroke-width="2"/>
  <text x="560" y="118" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#721c24">CRC-32 (I)</text>
  <text x="560" y="135" text-anchor="middle" font-family="monospace" font-size="12" fill="#721c24">checksum</text>
  
  <!-- Payload indicator -->
  <rect x="80" y="155" width="560" height="35" fill="#e9ecef" stroke="#6c757d" stroke-width="1" stroke-dasharray="5,3"/>
  <text x="360" y="177" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#495057">Payload (variable length, specified by Length field)</text>
  
  <!-- Code example -->
  <rect x="80" y="205" width="540" height="80" fill="#2d2d2d" rx="4"/>
  <text x="95" y="225" font-family="monospace" font-size="11" fill="#569cd6">import</text>
  <text x="145" y="225" font-family="monospace" font-size="11" fill="#9cdcfe"> struct, zlib</text>
  
  <text x="95" y="245" font-family="monospace" font-size="11" fill="#9cdcfe">header = struct.pack(</text>
  <text x="255" y="245" font-family="monospace" font-size="11" fill="#ce9178">"&gt;4sBBII"</text>
  <text x="335" y="245" font-family="monospace" font-size="11" fill="#9cdcfe">,</text>
  
  <text x="95" y="265" font-family="monospace" font-size="11" fill="#9cdcfe">    </text>
  <text x="115" y="265" font-family="monospace" font-size="11" fill="#ce9178">b"S9PK"</text>
  <text x="175" y="265" font-family="monospace" font-size="11" fill="#9cdcfe">, </text>
  <text x="190" y="265" font-family="monospace" font-size="11" fill="#b5cea8">1</text>
  <text x="200" y="265" font-family="monospace" font-size="11" fill="#9cdcfe">, </text>
  <text x="215" y="265" font-family="monospace" font-size="11" fill="#b5cea8">0</text>
  <text x="225" y="265" font-family="monospace" font-size="11" fill="#9cdcfe">, len(payload), zlib.crc32(payload) &amp; </text>
  <text x="515" y="265" font-family="monospace" font-size="11" fill="#b5cea8">0xFFFFFFFF</text>
  <text x="95" y="280" font-family="monospace" font-size="11" fill="#9cdcfe">)</text>
  
  <!-- Footer -->
  <text x="350" y="308" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#6c757d">Week 9: Presentation Layer â€” Binary Protocol Framing</text>
</svg>
