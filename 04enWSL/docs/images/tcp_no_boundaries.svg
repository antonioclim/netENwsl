<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 220">
  <defs>
    <style>
      .msg1 { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .msg2 { fill: #2ecc71; stroke: #27ae60; stroke-width: 2; }
      .msg3 { fill: #e67e22; stroke: #d35400; stroke-width: 2; }
      .tcp { fill: #ecf0f1; stroke: #bdc3c7; stroke-width: 2; }
      .label { font-family: monospace; font-size: 11px; fill: #2c3e50; }
      .title { font-family: sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .subtitle { font-family: sans-serif; font-size: 11px; fill: #7f8c8d; }
      .warning { font-family: sans-serif; font-size: 10px; fill: #e74c3c; font-weight: bold; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="350" y="25" class="title" text-anchor="middle">TCP Stream: No Message Boundaries (Common Misconception)</text>
  
  <!-- Application layer - what you send -->
  <text x="50" y="55" class="subtitle">Application sends 3 messages:</text>
  
  <rect x="50" y="65" width="120" height="30" class="msg1" rx="3"/>
  <text x="110" y="85" class="label" text-anchor="middle">MSG_1 (120B)</text>
  
  <rect x="180" y="65" width="80" height="30" class="msg2" rx="3"/>
  <text x="220" y="85" class="label" text-anchor="middle">MSG_2 (80B)</text>
  
  <rect x="270" y="65" width="150" height="30" class="msg3" rx="3"/>
  <text x="345" y="85" class="label" text-anchor="middle">MSG_3 (150B)</text>
  
  <!-- Arrow down -->
  <line x1="230" y1="100" x2="230" y2="120" class="arrow" marker-end="url(#arrowhead)"/>
  <text x="250" y="115" class="subtitle">TCP segments</text>
  
  <!-- TCP layer - what actually arrives -->
  <text x="50" y="145" class="subtitle">Receiver gets byte stream (boundaries lost!):</text>
  
  <rect x="50" y="155" width="200" height="30" class="tcp" rx="3"/>
  <text x="150" y="175" class="label" text-anchor="middle">Segment 1 (200B)</text>
  <!-- Show mixed content inside -->
  <rect x="52" y="157" width="118" height="26" class="msg1" rx="2" opacity="0.7"/>
  <rect x="172" y="157" width="76" height="26" class="msg2" rx="2" opacity="0.7"/>
  
  <rect x="260" y="155" width="150" height="30" class="tcp" rx="3"/>
  <text x="335" y="175" class="label" text-anchor="middle">Segment 2 (150B)</text>
  <rect x="262" y="157" width="2" height="26" class="msg2" rx="1" opacity="0.7"/>
  <rect x="266" y="157" width="142" height="26" class="msg3" rx="2" opacity="0.7"/>
  
  <!-- Warning -->
  <text x="500" y="165" class="warning">⚠️ MSG_2 split across</text>
  <text x="500" y="180" class="warning">   two TCP segments!</text>
  
  <!-- Solution hint -->
  <text x="50" y="210" class="subtitle">Solution: Use length-prefix framing to reconstruct message boundaries</text>
</svg>
