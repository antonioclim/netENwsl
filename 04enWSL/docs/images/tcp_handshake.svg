<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 500 320">
  <defs>
    <style>
      .entity { fill: #3498db; stroke: #2980b9; stroke-width: 2; }
      .lifeline { stroke: #bdc3c7; stroke-width: 2; stroke-dasharray: 5,5; }
      .arrow { stroke: #2c3e50; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-ack { stroke: #27ae60; stroke-width: 2; fill: none; marker-end: url(#arrowhead-green); }
      .label { font-family: sans-serif; font-size: 12px; fill: #2c3e50; font-weight: bold; }
      .msg { font-family: monospace; font-size: 10px; fill: #2c3e50; }
      .seq { font-family: monospace; font-size: 9px; fill: #7f8c8d; }
      .title { font-family: sans-serif; font-size: 14px; font-weight: bold; fill: #2c3e50; }
      .state { font-family: sans-serif; font-size: 9px; fill: #9b59b6; font-style: italic; }
      .note { font-family: sans-serif; font-size: 9px; fill: #7f8c8d; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#2c3e50"/>
    </marker>
    <marker id="arrowhead-green" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#27ae60"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="250" y="25" class="title" text-anchor="middle">TCP 3-Way Handshake</text>
  
  <!-- Entities -->
  <rect x="60" y="45" width="80" height="30" class="entity" rx="5"/>
  <text x="100" y="65" class="label" text-anchor="middle">Client</text>
  
  <rect x="360" y="45" width="80" height="30" class="entity" rx="5"/>
  <text x="400" y="65" class="label" text-anchor="middle">Server</text>
  
  <!-- Lifelines -->
  <line x1="100" y1="75" x2="100" y2="290" class="lifeline"/>
  <line x1="400" y1="75" x2="400" y2="290" class="lifeline"/>
  
  <!-- State annotations -->
  <text x="20" y="95" class="state">CLOSED</text>
  <text x="440" y="95" class="state">LISTEN</text>
  
  <!-- Step 1: SYN -->
  <line x1="100" y1="110" x2="390" y2="130" class="arrow"/>
  <text x="245" y="108" class="msg" text-anchor="middle">SYN</text>
  <text x="245" y="120" class="seq" text-anchor="middle">seq=1000</text>
  <text x="20" y="125" class="state">SYN_SENT</text>
  
  <!-- Step 2: SYN-ACK -->
  <line x1="400" y1="155" x2="110" y2="175" class="arrow-ack"/>
  <text x="255" y="153" class="msg" text-anchor="middle">SYN+ACK</text>
  <text x="255" y="165" class="seq" text-anchor="middle">seq=2000, ack=1001</text>
  <text x="440" y="165" class="state">SYN_RCVD</text>
  
  <!-- Step 3: ACK -->
  <line x1="100" y1="200" x2="390" y2="220" class="arrow-ack"/>
  <text x="245" y="198" class="msg" text-anchor="middle">ACK</text>
  <text x="245" y="210" class="seq" text-anchor="middle">seq=1001, ack=2001</text>
  
  <!-- Final states -->
  <text x="20" y="240" class="state">ESTABLISHED</text>
  <text x="440" y="240" class="state">ESTABLISHED</text>
  
  <!-- Connection established indicator -->
  <line x1="100" y1="250" x2="400" y2="250" stroke="#27ae60" stroke-width="3" stroke-dasharray="none"/>
  <text x="250" y="268" class="note" text-anchor="middle">Connection established â€” data transfer can begin</text>
  
  <!-- Notes -->
  <text x="250" y="295" class="note" text-anchor="middle">Note: ACK number = received SEQ + 1</text>
</svg>
