═══════════════════════════════════════════════════════════════════════════════
                    OPENFLOW FLOW MATCHING — Week 6
═══════════════════════════════════════════════════════════════════════════════

    PRIORITY SEMANTICS:
    ════════════════════

    ┌─────────────────────────────────────────────────────────────────────────┐
    │                                                                         │
    │   HIGHER number = HIGHER priority = CHECKED FIRST                       │
    │                                                                         │
    │   Priority 65535  ─────────────────────────────────►  Maximum (first)   │
    │   Priority 100    ─────────────────►  High                              │
    │   Priority 50     ──────────►  Medium                                   │
    │   Priority 10     ────►  Low                                            │
    │   Priority 0      ►  Minimum (table-miss, checked last)                 │
    │                                                                         │
    └─────────────────────────────────────────────────────────────────────────┘


    FLOW TABLE EXAMPLE:
    ════════════════════

    ┌───────────────────────────────────────────────────────────────────────┐
    │                        SWITCH s1 FLOW TABLE                           │
    ├──────────┬────────────────────────────────────┬───────────────────────┤
    │ Priority │              Match                 │        Action         │
    ├──────────┼────────────────────────────────────┼───────────────────────┤
    │   300    │ tcp, nw_dst=10.0.6.12, tp_dst=22   │ output:2 (allow SSH)  │
    │   200    │ icmp, nw_src=10.0.6.11             │ output:2 (allow ping) │
    │   100    │ ip, nw_src=10.0.6.11, nw_dst=10.0.6.12 │ output:2          │
    │   100    │ ip, nw_src=10.0.6.12, nw_dst=10.0.6.11 │ output:1          │
    │    50    │ ip, nw_dst=10.0.6.13               │ drop (block h3)       │
    │    10    │ arp                                │ FLOOD                 │
    │     0    │ (any)                              │ CONTROLLER            │
    └──────────┴────────────────────────────────────┴───────────────────────┘


    PACKET MATCHING PROCESS:
    ═════════════════════════

    Incoming Packet: TCP from 10.0.6.11 to 10.0.6.12:22 (SSH)

         ┌─────────────────────────────────────────────────────────────┐
         │  Packet arrives at switch                                   │
         └──────────────────────────┬──────────────────────────────────┘
                                    │
                                    ▼
         ┌─────────────────────────────────────────────────────────────┐
         │  Check Priority 300: tcp, nw_dst=10.0.6.12, tp_dst=22       │
         │  ┌─────────────────────────────────────────────────────┐    │
         │  │  TCP? ✓   Dst=10.0.6.12? ✓   Port=22? ✓   MATCH!   │    │
         │  └─────────────────────────────────────────────────────┘    │
         └──────────────────────────┬──────────────────────────────────┘
                                    │
                                    ▼
         ┌─────────────────────────────────────────────────────────────┐
         │  ACTION: output:2  →  Forward to port 2 (h2)                │
         └─────────────────────────────────────────────────────────────┘


    POLICY DESIGN PATTERN:
    ═══════════════════════

    "Allow specific, deny general, default action"

         ┌─────────────────────────────────────────────────────────────┐
         │                                                             │
         │   Priority 300:  SPECIFIC PERMIT   (SSH to server)          │
         │                          │                                  │
         │                          ▼                                  │
         │   Priority 50:   GENERAL DENY      (block everything to h3) │
         │                          │                                  │
         │                          ▼                                  │
         │   Priority 10:   DEFAULT ALLOW     (permit other traffic)   │
         │                          │                                  │
         │                          ▼                                  │
         │   Priority 0:    TABLE-MISS        (send to controller)     │
         │                                                             │
         └─────────────────────────────────────────────────────────────┘


    COMMON MISTAKE:
    ════════════════

    ┌─────────────────────────────────────────────────────────────────────────┐
    │  ❌ WRONG: Block at highest priority                                    │
    │     Priority 300: drop all to h3                                        │
    │     Priority 100: allow SSH to h3      ← NEVER REACHED!                 │
    │                                                                         │
    │  ✅ CORRECT: Permit at higher priority than deny                        │
    │     Priority 300: allow SSH to h3      ← Checked first, SSH works       │
    │     Priority 50:  drop all to h3       ← Everything else blocked        │
    └─────────────────────────────────────────────────────────────────────────┘


═══════════════════════════════════════════════════════════════════════════════
