<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 750 420" width="750" height="420">
  <title>Socket Options for Network Programming</title>
  <desc>Visual reference for socket options used in broadcast, multicast and TCP tunnelling</desc>
  
  <!-- Background -->
  <rect width="750" height="420" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="375" y="28" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#1e293b">
    Socket Options Quick Reference — Week 3
  </text>
  
  <!-- BROADCAST Section -->
  <g id="broadcast-options">
    <rect x="20" y="50" width="220" height="160" rx="8" fill="#fef2f2" stroke="#fca5a5" stroke-width="2"/>
    <rect x="20" y="50" width="220" height="30" rx="8" fill="#dc2626"/>
    <text x="130" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      BROADCAST
    </text>
    
    <!-- SO_BROADCAST -->
    <rect x="35" y="95" width="190" height="45" rx="4" fill="white" stroke="#fca5a5"/>
    <text x="130" y="112" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#b91c1c">SO_BROADCAST</text>
    <text x="130" y="128" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Required for sendto() to</text>
    <text x="130" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">broadcast addresses</text>
    
    <!-- SO_REUSEADDR -->
    <rect x="35" y="150" width="190" height="45" rx="4" fill="white" stroke="#fca5a5"/>
    <text x="130" y="167" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#b91c1c">SO_REUSEADDR</text>
    <text x="130" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Allow multiple receivers</text>
    <text x="130" y="193" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">on same port</text>
  </g>
  
  <!-- MULTICAST Section -->
  <g id="multicast-options">
    <rect x="260" y="50" width="230" height="250" rx="8" fill="#dcfce7" stroke="#86efac" stroke-width="2"/>
    <rect x="260" y="50" width="230" height="30" rx="8" fill="#16a34a"/>
    <text x="375" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      MULTICAST
    </text>
    
    <!-- IP_ADD_MEMBERSHIP -->
    <rect x="275" y="95" width="200" height="45" rx="4" fill="white" stroke="#86efac"/>
    <text x="375" y="112" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#166534">IP_ADD_MEMBERSHIP</text>
    <text x="375" y="128" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Join multicast group</text>
    <text x="375" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">(sends IGMP Report)</text>
    
    <!-- IP_DROP_MEMBERSHIP -->
    <rect x="275" y="150" width="200" height="45" rx="4" fill="white" stroke="#86efac"/>
    <text x="375" y="167" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#166534">IP_DROP_MEMBERSHIP</text>
    <text x="375" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Leave multicast group</text>
    <text x="375" y="193" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">(sends IGMP Leave)</text>
    
    <!-- IP_MULTICAST_TTL -->
    <rect x="275" y="205" width="200" height="45" rx="4" fill="white" stroke="#86efac"/>
    <text x="375" y="222" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#166534">IP_MULTICAST_TTL</text>
    <text x="375" y="238" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Set hop limit (TTL=1</text>
    <text x="375" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">= link-local only)</text>
    
    <!-- IP_MULTICAST_LOOP -->
    <rect x="275" y="260" width="200" height="30" rx="4" fill="white" stroke="#86efac"/>
    <text x="375" y="277" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#166534">IP_MULTICAST_LOOP</text>
  </g>
  
  <!-- TCP TUNNEL Section -->
  <g id="tcp-options">
    <rect x="510" y="50" width="220" height="160" rx="8" fill="#dbeafe" stroke="#93c5fd" stroke-width="2"/>
    <rect x="510" y="50" width="220" height="30" rx="8" fill="#3b82f6"/>
    <text x="620" y="70" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="white">
      TCP TUNNEL
    </text>
    
    <!-- SO_REUSEADDR -->
    <rect x="525" y="95" width="190" height="45" rx="4" fill="white" stroke="#93c5fd"/>
    <text x="620" y="112" text-anchor="middle" font-family="monospace" font-size="10" font-weight="bold" fill="#1e40af">SO_REUSEADDR</text>
    <text x="620" y="128" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Quick restart after</text>
    <text x="620" y="138" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">TIME_WAIT</text>
    
    <!-- Threading note -->
    <rect x="525" y="150" width="190" height="45" rx="4" fill="white" stroke="#93c5fd"/>
    <text x="620" y="167" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#1e40af">Threading Required</text>
    <text x="620" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Bidirectional relay needs</text>
    <text x="620" y="193" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#64748b">2 threads per connection</text>
  </g>
  
  <!-- Code Examples -->
  <rect x="20" y="320" width="710" height="90" rx="8" fill="#1e293b"/>
  <text x="375" y="340" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#94a3b8">
    Python Code Examples
  </text>
  
  <!-- Broadcast example -->
  <text x="40" y="360" font-family="monospace" font-size="9" fill="#fca5a5">
    sock.setsockopt(socket.SOL_SOCKET, socket.SO_BROADCAST, 1)
  </text>
  
  <!-- Multicast example -->
  <text x="40" y="378" font-family="monospace" font-size="9" fill="#86efac">
    mreq = socket.inet_aton(group) + struct.pack('=I', socket.INADDR_ANY)
  </text>
  <text x="40" y="393" font-family="monospace" font-size="9" fill="#86efac">
    sock.setsockopt(socket.IPPROTO_IP, socket.IP_ADD_MEMBERSHIP, mreq)
  </text>
  
  <!-- Legend / Notes -->
  <rect x="20" y="230" width="220" height="75" rx="4" fill="#f1f5f9" stroke="#e2e8f0"/>
  <text x="130" y="248" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#475569">Key Points</text>
  <text x="30" y="265" font-family="Arial, sans-serif" font-size="9" fill="#64748b">• SO_BROADCAST = safety check</text>
  <text x="30" y="280" font-family="Arial, sans-serif" font-size="9" fill="#64748b">• Multicast needs explicit JOIN</text>
  <text x="30" y="295" font-family="Arial, sans-serif" font-size="9" fill="#64748b">• TTL=1 stays in local segment</text>
</svg>
