<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 700 500" width="700" height="500">
  <title>IGMP Membership Flow</title>
  <desc>Sequence diagram showing IGMP join and leave process</desc>
  
  <!-- Background -->
  <rect width="700" height="500" fill="#f8fafc"/>
  
  <!-- Title -->
  <text x="350" y="30" text-anchor="middle" font-family="Arial, sans-serif" font-size="18" font-weight="bold" fill="#1e293b">
    IGMP Group Membership Flow
  </text>
  
  <!-- Actors -->
  <!-- Host -->
  <rect x="80" y="60" width="100" height="40" rx="4" fill="#dbeafe" stroke="#3b82f6" stroke-width="2"/>
  <text x="130" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#1e40af">HOST</text>
  <line x1="130" y1="100" x2="130" y2="460" stroke="#3b82f6" stroke-width="2"/>
  
  <!-- Switch -->
  <rect x="280" y="60" width="100" height="40" rx="4" fill="#fef3c7" stroke="#f59e0b" stroke-width="2"/>
  <text x="330" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#b45309">SWITCH</text>
  <line x1="330" y1="100" x2="330" y2="460" stroke="#f59e0b" stroke-width="2"/>
  
  <!-- Router -->
  <rect x="480" y="60" width="100" height="40" rx="4" fill="#dcfce7" stroke="#16a34a" stroke-width="2"/>
  <text x="530" y="85" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" font-weight="bold" fill="#166534">ROUTER</text>
  <line x1="530" y1="100" x2="530" y2="460" stroke="#16a34a" stroke-width="2"/>
  
  <!-- JOIN SEQUENCE -->
  <text x="50" y="140" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#64748b">JOIN</text>
  
  <!-- 1. Application calls IP_ADD_MEMBERSHIP -->
  <rect x="20" y="150" width="90" height="30" rx="2" fill="#eff6ff" stroke="#bfdbfe"/>
  <text x="65" y="165" text-anchor="middle" font-family="monospace" font-size="8" fill="#1e40af">IP_ADD_</text>
  <text x="65" y="175" text-anchor="middle" font-family="monospace" font-size="8" fill="#1e40af">MEMBERSHIP</text>
  
  <!-- 2. IGMP Membership Report -->
  <line x1="130" y1="190" x2="330" y2="210" stroke="#3b82f6" stroke-width="2" marker-end="url(#arrowBlue)"/>
  <rect x="170" y="185" width="120" height="20" rx="2" fill="#dbeafe"/>
  <text x="230" y="199" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#1e40af">IGMP Report (Join)</text>
  
  <!-- 3. Switch learns -->
  <rect x="260" y="220" width="140" height="25" rx="2" fill="#fef3c7"/>
  <text x="330" y="237" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#b45309">Updates multicast table</text>
  
  <!-- 4. Forward to Router -->
  <line x1="330" y1="250" x2="530" y2="270" stroke="#f59e0b" stroke-width="2" marker-end="url(#arrowOrange)"/>
  <rect x="370" y="245" width="120" height="20" rx="2" fill="#fef3c7"/>
  <text x="430" y="259" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#b45309">IGMP Report</text>
  
  <!-- 5. Router registers -->
  <rect x="460" y="280" width="140" height="25" rx="2" fill="#dcfce7"/>
  <text x="530" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="9" fill="#166534">Registers group member</text>
  
  <!-- LEAVE SEQUENCE -->
  <text x="50" y="340" font-family="Arial, sans-serif" font-size="11" font-weight="bold" fill="#64748b">LEAVE</text>
  
  <!-- 1. Application calls IP_DROP_MEMBERSHIP -->
  <rect x="20" y="350" width="90" height="30" rx="2" fill="#fef2f2" stroke="#fecaca"/>
  <text x="65" y="365" text-anchor="middle" font-family="monospace" font-size="8" fill="#dc2626">IP_DROP_</text>
  <text x="65" y="375" text-anchor="middle" font-family="monospace" font-size="8" fill="#dc2626">MEMBERSHIP</text>
  
  <!-- 2. IGMP Leave -->
  <line x1="130" y1="390" x2="330" y2="410" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowRed)"/>
  <rect x="170" y="385" width="120" height="20" rx="2" fill="#fef2f2"/>
  <text x="230" y="399" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">IGMP Leave</text>
  
  <!-- 3. Forward to Router -->
  <line x1="330" y1="420" x2="530" y2="440" stroke="#dc2626" stroke-width="2" marker-end="url(#arrowRed)"/>
  <rect x="370" y="415" width="120" height="20" rx="2" fill="#fef2f2"/>
  <text x="430" y="429" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" fill="#dc2626">IGMP Leave</text>
  
  <!-- Legend -->
  <rect x="550" y="130" width="140" height="90" rx="4" fill="#f1f5f9" stroke="#e2e8f0"/>
  <text x="620" y="148" text-anchor="middle" font-family="Arial, sans-serif" font-size="10" font-weight="bold" fill="#475569">Legend</text>
  <line x1="560" y1="160" x2="590" y2="160" stroke="#3b82f6" stroke-width="2"/>
  <text x="595" y="164" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Host → Network</text>
  <line x1="560" y1="180" x2="590" y2="180" stroke="#f59e0b" stroke-width="2"/>
  <text x="595" y="184" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Switch → Router</text>
  <line x1="560" y1="200" x2="590" y2="200" stroke="#dc2626" stroke-width="2"/>
  <text x="595" y="204" font-family="Arial, sans-serif" font-size="9" fill="#64748b">Leave message</text>
  
  <!-- Arrow markers -->
  <defs>
    <marker id="arrowBlue" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#3b82f6"/>
    </marker>
    <marker id="arrowOrange" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#f59e0b"/>
    </marker>
    <marker id="arrowRed" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#dc2626"/>
    </marker>
  </defs>
</svg>
