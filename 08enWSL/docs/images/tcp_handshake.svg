<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 600 400">
  <style>
    .title { font: bold 16px sans-serif; fill: #333; }
    .label { font: 12px sans-serif; fill: #333; }
    .small { font: 10px sans-serif; fill: #666; }
    .seq { font: bold 11px monospace; fill: #1976d2; }
    .state { font: 10px sans-serif; fill: #666; font-style: italic; }
    .arrow { fill: none; stroke: #333; stroke-width: 2; marker-end: url(#arrow); }
    .client-line { stroke: #1976d2; stroke-width: 3; }
    .server-line { stroke: #388e3c; stroke-width: 3; }
  </style>
  
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="300" y="30" text-anchor="middle" class="title">TCP Three-Way Handshake</text>
  
  <!-- Timeline headers -->
  <text x="120" y="60" text-anchor="middle" class="label">CLIENT</text>
  <text x="480" y="60" text-anchor="middle" class="label">SERVER</text>
  
  <!-- Vertical timelines -->
  <line x1="120" y1="80" x2="120" y2="360" class="client-line"/>
  <line x1="480" y1="80" x2="480" y2="360" class="server-line"/>
  
  <!-- State labels - Client -->
  <text x="40" y="95" class="state">CLOSED</text>
  <text x="40" y="175" class="state">SYN_SENT</text>
  <text x="40" y="295" class="state">ESTABLISHED</text>
  
  <!-- State labels - Server -->
  <text x="510" y="95" class="state">LISTEN</text>
  <text x="510" y="175" class="state">SYN_RCVD</text>
  <text x="510" y="295" class="state">ESTABLISHED</text>
  
  <!-- Packet 1: SYN -->
  <path d="M130 120 L470 160" class="arrow"/>
  <rect x="220" y="120" width="160" height="35" rx="4" fill="#e3f2fd" stroke="#1976d2"/>
  <text x="300" y="137" text-anchor="middle" class="label">SYN</text>
  <text x="300" y="150" text-anchor="middle" class="seq">seq=100</text>
  
  <!-- Packet 2: SYN-ACK -->
  <path d="M470 200 L130 240" class="arrow"/>
  <rect x="220" y="200" width="160" height="35" rx="4" fill="#e8f5e9" stroke="#388e3c"/>
  <text x="300" y="217" text-anchor="middle" class="label">SYN-ACK</text>
  <text x="300" y="230" text-anchor="middle" class="seq">seq=300, ack=101</text>
  
  <!-- Packet 3: ACK -->
  <path d="M130 280 L470 320" class="arrow"/>
  <rect x="220" y="280" width="160" height="35" rx="4" fill="#fff3e0" stroke="#f57c00"/>
  <text x="300" y="297" text-anchor="middle" class="label">ACK</text>
  <text x="300" y="310" text-anchor="middle" class="seq">seq=101, ack=301</text>
  
  <!-- Explanatory notes -->
  <text x="300" y="355" text-anchor="middle" class="small">After ACK: Both sides in ESTABLISHED state</text>
  <text x="300" y="370" text-anchor="middle" class="small">ack = received_seq + 1 (next expected byte)</text>
  <text x="300" y="385" text-anchor="middle" class="small">Connection ready for data transfer</text>
</svg>
