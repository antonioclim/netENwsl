<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 320" width="400" height="320">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#333"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="200" y="25" text-anchor="middle" font-family="Arial, sans-serif" font-size="16" font-weight="bold" fill="#333">TCP Three-Way Handshake</text>
  
  <!-- Client column -->
  <rect x="40" y="45" width="80" height="30" rx="5" fill="#4a90d9" stroke="#2c5aa0" stroke-width="2"/>
  <text x="80" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Client</text>
  <line x1="80" y1="75" x2="80" y2="290" stroke="#4a90d9" stroke-width="3"/>
  
  <!-- Server column -->
  <rect x="280" y="45" width="80" height="30" rx="5" fill="#5cb85c" stroke="#3d8b3d" stroke-width="2"/>
  <text x="320" y="65" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="white" font-weight="bold">Server</text>
  <line x1="320" y1="75" x2="320" y2="290" stroke="#5cb85c" stroke-width="3"/>
  
  <!-- State: LISTEN -->
  <text x="355" y="95" font-family="Arial, sans-serif" font-size="10" fill="#666" font-style="italic">LISTEN</text>
  
  <!-- Step 1: SYN -->
  <line x1="85" y1="110" x2="315" y2="140" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="150" y="110" width="100" height="22" rx="3" fill="#fff3cd" stroke="#ffc107" stroke-width="1"/>
  <text x="200" y="125" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#856404">SYN (seq=x)</text>
  <text x="45" y="115" font-family="Arial, sans-serif" font-size="10" fill="#666" font-style="italic">SYN_SENT</text>
  
  <!-- Step 2: SYN-ACK -->
  <line x1="315" y1="170" x2="85" y2="200" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="130" y="168" width="140" height="22" rx="3" fill="#d4edda" stroke="#28a745" stroke-width="1"/>
  <text x="200" y="183" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#155724">SYN-ACK (seq=y, ack=x+1)</text>
  <text x="355" y="175" font-family="Arial, sans-serif" font-size="10" fill="#666" font-style="italic">SYN_RCVD</text>
  
  <!-- Step 3: ACK -->
  <line x1="85" y1="230" x2="315" y2="260" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
  <rect x="150" y="230" width="100" height="22" rx="3" fill="#cce5ff" stroke="#007bff" stroke-width="1"/>
  <text x="200" y="245" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="#004085">ACK (ack=y+1)</text>
  
  <!-- State: ESTABLISHED -->
  <rect x="130" y="280" width="140" height="25" rx="5" fill="#d4edda" stroke="#28a745" stroke-width="2"/>
  <text x="200" y="297" text-anchor="middle" font-family="Arial, sans-serif" font-size="12" fill="#155724" font-weight="bold">ESTABLISHED</text>
  
  <!-- Step numbers -->
  <circle cx="25" y="125" r="12" fill="#4a90d9"/>
  <text x="25" y="130" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">1</text>
  
  <circle cx="375" y="185" r="12" fill="#5cb85c"/>
  <text x="375" y="190" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">2</text>
  
  <circle cx="25" y="245" r="12" fill="#007bff"/>
  <text x="25" y="250" text-anchor="middle" font-family="Arial, sans-serif" font-size="11" fill="white" font-weight="bold">3</text>
</svg>
